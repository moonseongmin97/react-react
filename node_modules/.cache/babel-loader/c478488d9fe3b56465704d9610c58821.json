{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\Desktop\\\\68REACT\\\\68REACT\\\\68REACT\\\\src\\\\erp\\\\hr\\\\attendance\\\\page\\\\DayAttdManage\\\\DayAttdManage.js\";\nimport React, { useCallback, useState } from \"react\";\nimport Grid from \"./Grid\";\nimport \"./DayAttdManage.css\";\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography, AppBar, Toolbar } from \"@material-ui/core\";\nimport Axios from \"axios\"; //==============================재영 일근태관리==============================//\n\nconst DayAttdManage = ({\n  searchDayAttd,\n  searchMonthAttdMgtList,\n  dayAttdMgtList,\n  updateDayAttdList,\n  errorCode,\n  errorMsg\n}) => {\n  const [date, setDate] = useState('');\n  const onChange = useCallback(e => {\n    setDate(e.target.value.toString());\n  }, []);\n\n  const search = () => {\n    searchDayAttd(date);\n  }; //마지막 문자열 찾아서 교체하는 함수\n\n\n  const replaceLast = (str, regex, replacement) => {\n    var regexIndexOf = str.lastIndexOf(regex);\n\n    if (regexIndexOf === -1) {\n      return str;\n    } else {\n      /* 넘어오는 regex가 number타입이기 때문에 length가 안먹힘 그래서 toString으로 문자열로 변경후 사용 */\n      return str.substring(0, regexIndexOf) + replacement + str.substring(regexIndexOf + regex.toString().length);\n    }\n  }; //이미 만들어져 있는 사가를 이용해서 처리하고 싶었지만 비동기처리를 피하기 위해 함수를 나눔\n\n\n  const monthList = e => {\n    //버튼ID값을 넘겨주기 위함\n    let buttonId = e.currentTarget.id; //일근태 마감 전 월근태 마감 여부 검사\n    //월근태 조회 조건을 맞추기 위한 작업 ex)2020-08-20 => 2020-8 \n\n    let dayAttdMonthData = date.substring(0, date.lastIndexOf(\"-\"));\n\n    if (date.substring(5, 6) === '0') {\n      dayAttdMonthData = replaceLast(dayAttdMonthData, 0, \"\");\n    }\n\n    Axios.get(\"http://localhost:8282/hr/insa/attendance/monthAttendanceManage.do\", {\n      params: {\n        applyYearMonth: dayAttdMonthData\n      }\n    }).then(response => {\n      //실제 마감이벤트 호출\n      finalize(response, buttonId, dayAttdMonthData);\n    }).catch(err => {\n      console.log(err);\n    });\n  }; //마감이벤트\n\n\n  const finalize = (response, buttonId, dayAttdMonthData) => {\n    const monthAttd = response.data.monthAttdMgtList;\n\n    if (monthAttd[0].finalizeStatus === 'Y') {\n      alert('월 근태 마감을 확인해 주세요');\n      return;\n    }\n\n    const dayAttd = dayAttdMgtList;\n\n    for (let i = 0; i < dayAttd.length; i++) {\n      delete dayAttd[i].errorCode;\n      delete dayAttd[i].errorMsg;\n      delete dayAttd[i].chk; //전체마감\n\n      if (buttonId === 'update') {\n        if (dayAttd[i].finalizeStatus === 'Y') {\n          alert('이미 마감처리 되었습니다.');\n          return;\n        }\n\n        dayAttd[i].status = 'update';\n      } else {\n        //마감취소\n        if (dayAttd[i].finalizeStatus === 'N') {\n          alert('마감처리를 확인해주세요.');\n          return;\n        }\n\n        dayAttd[i].status = 'cancel';\n      }\n    }\n\n    console.log(\"update-view\" + JSON.stringify(dayAttd));\n    updateDayAttdList({\n      dayAttdMgtList: dayAttd,\n      cday: dayAttdMonthData\n    });\n\n    if (!!errorMsg) {\n      alert(errorMsg);\n    }\n\n    if (!!dayAttdMgtList) {\n      alert('요청하신 처리가 완료 되었습니다.');\n    }\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ui primary segment\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(AppBar, {\n    position: \"static\",\n    color: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(Toolbar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    component: \"h2\",\n    variant: \"h4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"\\uC77C\\uADFC\\uD0DC\\uAD00\\uB9AC\")))), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    align: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(\"fieldset\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"legend\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, \" [ \\uAC80\\uC0C9\\uC870\\uAC74 ] \"), React.createElement(TextField, {\n    name: \"searchDate\",\n    type: \"date\",\n    onChange: onChange,\n    defaultValue: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"box\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: search,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"\\uC870\\uD68C\\uD558\\uAE30\"), React.createElement(Button, {\n    id: \"update\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: monthList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"\\uC804\\uCCB4\\uB9C8\\uAC10\\uD558\\uAE30\"), React.createElement(Button, {\n    id: \"cancel\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: monthList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \"\\uC804\\uCCB4\\uB9C8\\uAC10\\uCDE8\\uC18C\"))))), React.createElement(\"div\", {\n    className: \"box\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    data: dayAttdMgtList,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  })));\n};\n\nexport default DayAttdManage;","map":{"version":3,"sources":["C:/Users/USER/Desktop/68REACT/68REACT/68REACT/src/erp/hr/attendance/page/DayAttdManage/DayAttdManage.js"],"names":["React","useCallback","useState","Grid","Button","TextField","Typography","AppBar","Toolbar","Axios","DayAttdManage","searchDayAttd","searchMonthAttdMgtList","dayAttdMgtList","updateDayAttdList","errorCode","errorMsg","date","setDate","onChange","e","target","value","toString","search","replaceLast","str","regex","replacement","regexIndexOf","lastIndexOf","substring","length","monthList","buttonId","currentTarget","id","dayAttdMonthData","get","params","applyYearMonth","then","response","finalize","catch","err","console","log","monthAttd","data","monthAttdMgtList","finalizeStatus","alert","dayAttd","i","chk","status","JSON","stringify","cday"],"mappings":"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","sourcesContent":["import React, { useCallback, useState } from \"react\";\nimport Grid from \"./Grid\";\nimport \"./DayAttdManage.css\";\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography, AppBar, Toolbar } from \"@material-ui/core\"\nimport Axios from \"axios\";\n\n//==============================재영 일근태관리==============================//\n\nconst DayAttdManage = ({ searchDayAttd, searchMonthAttdMgtList, dayAttdMgtList, updateDayAttdList, errorCode, errorMsg }) => {\n\n  const [date, setDate] = useState('');\n  \n  const onChange = useCallback((e) => {\n    setDate((e.target.value).toString());\n  }, []);\n\n  const search = () => {\n    searchDayAttd(date);\n  };\n\n  //마지막 문자열 찾아서 교체하는 함수\n const replaceLast = (str, regex, replacement) => {\n\t\tvar regexIndexOf = str.lastIndexOf(regex);\n\t\tif (regexIndexOf === -1) {\n\t\t\treturn str;\n\t\t} else {\n\t\t\t/* 넘어오는 regex가 number타입이기 때문에 length가 안먹힘 그래서 toString으로 문자열로 변경후 사용 */\n\t\t\treturn str.substring(0, regexIndexOf) + replacement\n\t\t\t\t\t+ str.substring(regexIndexOf + regex.toString().length);\n\t\t}\n  }\n\n  //이미 만들어져 있는 사가를 이용해서 처리하고 싶었지만 비동기처리를 피하기 위해 함수를 나눔\n  const monthList = (e) => {\n  //버튼ID값을 넘겨주기 위함\n  let buttonId = e.currentTarget.id;\n  //일근태 마감 전 월근태 마감 여부 검사\n  //월근태 조회 조건을 맞추기 위한 작업 ex)2020-08-20 => 2020-8 \n  let dayAttdMonthData = date.substring(0, date.lastIndexOf(\"-\"));\n\n  if (date.substring(5, 6) === '0'){\n  dayAttdMonthData = replaceLast(dayAttdMonthData, 0, \"\");\n  }\n\n   Axios.get(\"http://localhost:8282/hr/insa/attendance/monthAttendanceManage.do\",{         \n      params:{ \n        applyYearMonth: dayAttdMonthData,\n      }\n    }).then(response => {\n    //실제 마감이벤트 호출\n     finalize(response, buttonId, dayAttdMonthData)\n    })\n    .catch(err => {\n      console.log(err)\n    });\n}\n  \n  //마감이벤트\n  const finalize = (response, buttonId, dayAttdMonthData) => {\n\n    const monthAttd = response.data.monthAttdMgtList;\n\n    if(monthAttd[0].finalizeStatus==='Y'){\n      alert('월 근태 마감을 확인해 주세요');\n      return;\n    }\n    const dayAttd = dayAttdMgtList;\n    \n    for(let i=0; i<dayAttd.length; i++){ \n     delete dayAttd[i].errorCode\n     delete dayAttd[i].errorMsg\n     delete dayAttd[i].chk    \n     //전체마감\n     if(buttonId === 'update'){\n      if(dayAttd[i].finalizeStatus === 'Y'){\n        alert('이미 마감처리 되었습니다.');\n        return;\n      } \n      dayAttd[i].status='update'\n    }else{ //마감취소\n      if(dayAttd[i].finalizeStatus === 'N'){\n        alert('마감처리를 확인해주세요.');\n        return;\n      } \n      dayAttd[i].status='cancel'\n    }\n  }  \n    console.log(\"update-view\"+JSON.stringify(dayAttd));\n   \n    updateDayAttdList({dayAttdMgtList:dayAttd, cday:dayAttdMonthData})\n    if(!!errorMsg){\n      alert(errorMsg);\n    }\n    if(!!dayAttdMgtList){\n      alert('요청하신 처리가 완료 되었습니다.');\n    }\n  };\n\n    return (\n     \n      <div>\n        <React.Fragment>\n        <div className=\"ui primary segment\">      \n        <AppBar position=\"static\" color=\"primary\">\n        <Toolbar>\n          <Typography component=\"h2\" variant=\"h4\">\n          일근태관리         \n          </Typography>\n        </Toolbar>\n      </AppBar>     \n      </div>\n      <br />\n      <div align='center'>\n      <fieldset>\n        <legend> [ 검색조건 ] </legend>\n       < TextField\n        name=\"searchDate\"\n        type={\"date\"}\n        onChange={onChange}  \n        defaultValue=\"\"\n       />\n       <br />\n       <div className=\"box\">\n       <Button variant=\"contained\" color=\"primary\" onClick={search}>\n          조회하기\n        </Button> \n        <Button id=\"update\" variant=\"contained\" color=\"primary\" onClick={monthList}>\n         전체마감하기\n        </Button>\n        <Button id=\"cancel\" variant=\"contained\" color=\"primary\" onClick={monthList}>\n         전체마감취소\n        </Button>\n        </div>\n      </fieldset>\n      </div>\n       </React.Fragment>\n       \n        <div className=\"box\" >        \n        <Grid data={dayAttdMgtList} />\n        </div>\n      </div>\n    );\n  }\n\nexport default DayAttdManage;"]},"metadata":{},"sourceType":"module"}